

# =============================================================================
# Base Docker Compose
# =============================================================================

# BEFORE LOCALLY BUILDING: SET THIS DOCKER_BUILDKIT=1, COMPOSE_DOCKER_CLI_BUILD=1 in the terminal

# Shared service definitions. Extend per environment:
#   docker compose -f docker-compose.yml -f docker-compose.dev.yml up
#   docker compose -f docker-compose.yml -f docker-compose.staging.yml up
#   docker compose -f docker-compose.yml -f docker-compose.prod.yml up
# =============================================================================

services:
  nexus-web:
    build:
      context: .
      dockerfile: apps/nexus-web/Dockerfile
    ports:
      - "3000:3000"

  nexus-api:
    build:
      context: .
      dockerfile: apps/nexus-api/Dockerfile
    ports:
      - "${NEXUS_API_PORT:-8000}:8000"
    environment:
      - PORT=8000

  identity-api:
    build:
      context: .
      dockerfile: apps/identity-api/Dockerfile
    ports:
      - "8100:8100"
    environment:
      - PORT=8100
